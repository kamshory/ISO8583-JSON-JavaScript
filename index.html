<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RoyISO8583</title>
    <script src="iso-8583.js"></script>
    <link rel="stylesheet" href="css.css">
</head>
<body>
    <script>
        window.onload = function()
        {
            
        }
        function parseISOMessage()
        {
            var iso = new RoyISO8583();
            var message = document.querySelector('textarea.iso').value;
            iso.parse(message);
            var values = iso.getData();
            var tbody = document.querySelector('.iso-container .iso-data-container table tbody');
            
            var notNull = false;
            do
            {
                var element = document.querySelector('.iso-container .iso-data-container table tbody tr');
                notNull = element != null;
                if(notNull)
                {
                    element.parentNode.removeChild(element)
                }
            }
            while(notNull);

            values[0] = iso.getType();
            for(i in values)
            {
                var tr = document.createElement('tr');
                var td1 = document.createElement('td');
                var td2 = document.createElement('td');
                td1.innerText = i;
                td2.innerText = values[i];
                tr.appendChild(td1);
                tr.appendChild(td2);
                tbody.appendChild(tr);
            }
        }

    </script>

    <div class="iso-container">
        <div class="iso-message-container">

        <form action="">
            <div class="form-control-wrapper">
                <textarea name="iso" id="iso" class="iso" class="textarea" rows="3">0200B23A400108818000000000001000010A370000000000000000112707241600000414241311281128601204alto000000000248KOI             034PI06054501CN12522030064594AC042500360071234567123eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJBTFRPIiwiZXhwIjoxNjA2NzIyMTI5fQ.tyJ5WjfiuuG3AH5ugaXlNNXPlZocDJnPpsnC7x-12_M00009071234567</textarea>
            </div>
            <div class="form-control-wrapper">
                <input type="button" value="Parse" id="parse" onclick="parseISOMessage()">
            </div>
            
        </form>

            
        </div>
        <div class="iso-data-container">
            <table width="100%" border="1" style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td width="40">Field</td>
                        <td>Value</td>
                    </tr>
                </thead>
                <tbody>
                </tbody>           
            </table>
        </div>
            
    </div>
</body>
</html>
